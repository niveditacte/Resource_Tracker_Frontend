<div class="home-content">
    <!-- Header -->
    <div class="header-container">
        <h2 class="app-title">Welcome to Resource Tracker App</h2>
        <p class="tagline">Manage your resources with clarity and control.</p>
    </div>

    <!-- Main Grid Card -->
    <div class="k-card k-shadow-lg grid-card">
        
        <!-- Bulk Actions -->
        <div class="bulk-actions">
            <button 
                kendoButton 
                look="flat" 
                class="bulk-edit-btn"
                [disabled]="selectedEmpIds.length === 0" 
                (click)="showBulkEditDialog = true">
                <mat-icon>edit</mat-icon>
                <span>Edit Selected ({{selectedEmpIds.length}})</span>
            </button>
        </div>

        <!-- Kendo Grid -->
        <kendo-grid
            class="k-grid themed-grid"
            [kendoGridBinding]="resourcesArray"
            [filterable]="true"
            [sortable]="true"
            [groupable]="true"
            [pageable]="{
                buttonCount: 5,
                info: true,
                type: 'numeric',
                pageSizes: true,
                previousNext: true
            }"
            [pageSize]="5"
            [reorderable]="true"
            [resizable]="true"
            [columnMenu]="true"
            [(selectedKeys)]="selectedEmpIds"
            kendoGridSelectBy="empId"
            [selectable]="{checkboxOnly: true, mode: 'multiple'}">

            <!-- Checkbox Column -->
            <kendo-grid-checkbox-column [width]="50" [columnMenu]="false"></kendo-grid-checkbox-column>
            
            <!-- EMP ID Column -->
            <kendo-grid-column field="empId" title="EMP ID">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <span class="emp-id-badge">{{ 'E' + (dataItem.empId.toString().padStart(4, '0')) }}</span>
                </ng-template>
            </kendo-grid-column>
            
            <!-- Resource Name Column -->
            <kendo-grid-column field="employee_Name" title="Resource Name">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <span class="resource-name">{{ dataItem.employee_Name }}</span>
                </ng-template>
            </kendo-grid-column>
            
            <!-- Billable Column -->
            <kendo-grid-column field="billable" title="Billable">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <span 
                        class="billable-status" 
                        [class.billable-yes]="dataItem.billable === 'Yes'" 
                        [class.billable-no]="dataItem.billable === 'No'">
                        {{ dataItem.billable }}
                    </span>
                </ng-template>
            </kendo-grid-column>
            
            <!-- Other Columns -->
            <kendo-grid-column field="designation_Name" title="Designation"></kendo-grid-column>
            <kendo-grid-column field="reportingToName" title="Reporting To"></kendo-grid-column>
            <kendo-grid-column field="projects" title="Project Allocation" [hidden]="true"></kendo-grid-column>
            <kendo-grid-column field="skills" title="Technology/Skill" [hidden]="true"></kendo-grid-column>
            <kendo-grid-column field="location_Name" title="Location"></kendo-grid-column>
            <kendo-grid-column field="emailId" title="Email ID" [hidden]="true"></kendo-grid-column>
            <kendo-grid-column field="ctE_DOJ" title="CTE DOJ" [hidden]="true"></kendo-grid-column>
            <kendo-grid-column field="remarks" title="Remarks" [hidden]="true"></kendo-grid-column>

            <!-- Actions Column -->
            <kendo-grid-column title="Actions" [width]="240" [columnMenu]="false">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <div class="action-buttons">
                        <button 
                            *ngIf="isAdmin || isManager" 
                            class="action-btn edit-btn"
                            kendoButton 
                            look="flat"
                            (click)="onEdit(dataItem.empId)">
                            <mat-icon>edit</mat-icon>
                            <span>Edit</span>
                        </button>
                        <button 
                            class="action-btn view-btn"
                            kendoButton 
                            look="flat"
                            (click)="onShowClick(dataItem.empId)">
                            <mat-icon>visibility</mat-icon>
                            <span>View</span>
                        </button>
                        <button 
                            *ngIf="isAdmin || isManager || isHR" 
                            class="action-btn delete-btn"
                            kendoButton 
                            look="flat"
                            (click)="openDeleteDialog(dataItem.empId)">
                            <mat-icon>delete</mat-icon>
                            <span>Delete</span>
                        </button>
                    </div>
                </ng-template>
            </kendo-grid-column>
        </kendo-grid>

        <!-- Bulk Edit Dialog -->
        <kendo-dialog *ngIf="showBulkEditDialog" (close)="showBulkEditDialog = false" class="themed-dialog">
            <kendo-dialog-titlebar>
                <mat-icon>edit</mat-icon>
                <span>Bulk Edit Selected Employees</span>
            </kendo-dialog-titlebar>

            <form (ngSubmit)="submitBulkUpdate()" class="bulk-edit-form">
                <div *ngFor="let field of editableFields" class="field-container">
                    <label class="field-checkbox">
                        <input type="checkbox" [(ngModel)]="field.selected" [name]="field.key + '_chk'">
                        <span class="checkmark"></span>
                        <span class="field-label">{{ field.label }}</span>
                    </label>

                    <div *ngIf="field.selected" class="field-input">
                        <!-- Dropdown Fields -->
                        <select 
                            *ngIf="isDropdown(field.key)" 
                            [(ngModel)]="field.value" 
                            [name]="field.key" 
                            class="themed-select">
                            <option [ngValue]="''" disabled selected>Select {{ field.label }}</option>
                            <option *ngFor="let option of getOptions(field.key)" [ngValue]="option[field.key]">
                                {{ option[field.dataLabel] }}
                            </option>
                        </select>

                        <!-- Billable Field -->
                        <ng-container *ngIf="field.key === 'billable'">
                            <select [(ngModel)]="field.value" [name]="field.key" class="themed-select">
                                <option [ngValue]="''" disabled selected>Select Billable</option>
                                <option [ngValue]="'Yes'">Yes</option>
                                <option [ngValue]="'No'">No</option>
                            </select>
                        </ng-container>

                        <!-- Text Fields -->
                        <input 
                            *ngIf="!isDropdown(field.key) && field.key !== 'billable'" 
                            [(ngModel)]="field.value" 
                            [name]="field.key" 
                            class="themed-input" 
                            placeholder="New {{ field.label }}" />
                    </div>
                </div>

                <kendo-dialog-actions>
                    <button class="dialog-btn cancel-btn" type="button" (click)="showBulkEditDialog = false">
                        <mat-icon>close</mat-icon>
                        Cancel
                    </button>
                    <button class="dialog-btn apply-btn" type="submit">
                        <mat-icon>check</mat-icon>
                        Apply Changes
                    </button>
                </kendo-dialog-actions>
            </form>
        </kendo-dialog>

        <!-- Delete Confirmation Dialog -->
        <kendo-dialog *ngIf="showDialog" (close)="cancelDelete()" class="themed-dialog">
            <kendo-dialog-titlebar>
                <mat-icon class="warning-icon">warning</mat-icon>
                <span>Confirm Delete</span>
            </kendo-dialog-titlebar>
            <div class="dialog-content">
                <p>Are you sure you want to delete this employee?</p>
                <p class="warning-text">This action cannot be undone.</p>
            </div>
            <kendo-dialog-actions>
                <button class="dialog-btn cancel-btn" (click)="cancelDelete()">
                    <mat-icon>close</mat-icon>
                    Cancel
                </button>
                <button class="dialog-btn delete-btn-dialog" (click)="onDelete(empIdToDelete)">
                    <mat-icon>delete</mat-icon>
                    Delete
                </button>
            </kendo-dialog-actions>
        </kendo-dialog>

        <!-- Bulk Update Confirmation Dialog -->
        <kendo-dialog *ngIf="showConfirmationDialog" class="themed-dialog">
            <kendo-dialog-titlebar>
                <mat-icon>info</mat-icon>
                <span>Confirm Bulk Update</span>
            </kendo-dialog-titlebar>
            
            <div class="dialog-content confirmation-content">
                <p class="message">
                    Are you sure you want to update
                    <strong class="highlight">{{ confirmationData.empIds.length }}</strong> employee(s)?
                </p>

                <div class="info-section">
                    <p class="section-label"><mat-icon>badge</mat-icon> Emp IDs:</p>
                    <div class="emp-ids-container">
                        <span class="emp-id-chip" *ngFor="let id of confirmationData.empIds">{{ id }}</span>
                    </div>
                </div>

                <div class="info-section">
                    <p class="section-label"><mat-icon>edit</mat-icon> Changes:</p>
                    <div class="change-list">
                        <div class="change-item" *ngFor="let key of objectKeys(confirmationData.updatedFields)">
                            <span class="field-name">{{ getFieldLabel(key) }}</span>
                            <mat-icon class="arrow-icon">arrow_forward</mat-icon>
                            <span class="field-value">"{{ confirmationData.updatedFields[key] }}"</span>
                        </div>
                    </div>
                </div>
            </div>

            <kendo-dialog-actions>
                <button class="dialog-btn cancel-btn" (click)="cancelConfirmation()">
                    <mat-icon>close</mat-icon>
                    Cancel
                </button>
                <button class="dialog-btn confirm-btn" (click)="confirmBulkUpdate()">
                    <mat-icon>check_circle</mat-icon>
                    Confirm Update
                </button>
            </kendo-dialog-actions>
        </kendo-dialog>
    </div>
</div>
